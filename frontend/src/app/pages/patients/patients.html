<main id="container">
  <section class="wrapper">
    <div class="wrapper-container">
      <div class="wrapper-container-header">
        <div>
          <h1>Pacientes</h1>
          <p>Registre e visualize pacientes</p>
        </div>
        <div class="header-actions">
          <button (click)="onNewPatient()" mat-flat-button class="radius" [disabled]="isLoading">
            <mat-icon>add</mat-icon>
            Novo Paciente
          </button>
        </div>
      </div>

      <div class="dashboard-cards">
        <div class="dashboard-card total-card">
          <div class="card-content">
            <div class="card-label">Paciente(s)</div>
            <div class="card-value">
              {{ totalItems }}
            </div>
          </div>
          <mat-icon class="card-icon">group</mat-icon>
        </div>
      </div>

      <div class="wrapper-container-content">
        @if (isLoading) {
        <div class="loading-container">
          <mat-spinner></mat-spinner>
        </div>
        }
        <section class="custom-section">
          <div class="custom-section-card">
            <div class="card-container">
              @if (!dataSource.data.length) {
              <div class="error-label text-align-center">
                <h5>Não há pacientes registrados</h5>
              </div>
              } @else {
              <div class="search-container">
                <div class="width-100 d-flex gap">
                  <div class="custom-search-input">
                    <mat-icon class="search-icon">search</mat-icon>
                    <input
                      [disabled]="isLoading || isBusy"
                      type="text"
                      (keyup)="onApplyFilter($event)"
                      placeholder="Buscar por nome, email ou telefone..."
                    />
                  </div>
                </div>
              </div>

              <table id="table" mat-table [dataSource]="dataSource" matSort>
                <ng-container matColumnDef="name">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Nome</th>
                  <td mat-cell *matCellDef="let row">{{ row.name.toUpperCase() }}</td>
                </ng-container>

                <ng-container matColumnDef="document">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Documento</th>
                  <td mat-cell *matCellDef="let row">{{ row.document || '--' }}</td>
                </ng-container>

                <ng-container matColumnDef="actions">
                  <th mat-header-cell *matHeaderCellDef></th>
                  <td mat-cell *matCellDef="let row">
                    <div class="actions">
                      <button
                        mat-icon-button
                        (click)="$event.stopPropagation(); onEditPatient(row)"
                      >
                        <mat-icon>edit</mat-icon>
                      </button>
                      <button
                        mat-icon-button
                        (click)="$event.stopPropagation(); onDeletePatient(row)"
                      >
                        <mat-icon fontSet="material-icons-outlined" class="error-color">
                          delete
                        </mat-icon>
                      </button>
                    </div>
                  </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns" class="table-row"></tr>
              </table>

              }
            </div>
          </div>
        </section>

        <mat-paginator
          [disabled]="isLoading || isBusy"
          [length]="totalItems"
          [pageSize]="pageSize"
          [pageSizeOptions]="pageSizeOptions"
          showFirstLastButtons
          aria-label="Selecionar página"
        >
        </mat-paginator>
      </div>
    </div>
  </section>
</main>
